---
layout: post
title: "广州之行"
subtitle: ""
author: "yangchw"
catalog: false
date: 2013-12-06 12:22:00
header-img: "assets/img/home-bg。png"
header-mask: 0.5
tags:
  - 广州
---

![广州小蛮腰](http://moodpo.com/usr/uploads/2014/01/1474482776.jpg)

从广州回来已经快一个月了，我才想起要总结一下的。

是的，很需要总结一下。不必说我们团队一起度过的无眠的夜晚，也不比说广州的现场环境的千奇百怪的复杂，单单只说上线晚上我紧急发布的补丁个数，就与别的省份的情况不可同日而语了。当然，我只去过广州，别的省份没有切身的体会，但从各种道听途说的消息来判断，也可见一斑。

十月八号到达广州，而月底是我们的上线时间，一开始我们不说信心满满，至少心里有底，因为我们在公司这边已经进行了三轮测试，虽然还存在Bug，但都不是什么严重问题。然而，事情并不是我想象的那样简单。首先的就是数据迁移这座大山挡在了我们面前——广东的数据在所有省份中是最多的，也是最为复杂的。经过千辛万苦，ESA的数据迁移过来了，然而LDAP的数据却成了难题，尤其是authorizations那个节点下的授权关系数据，UDI迁移工具跑了一个晚上，到第二天一不小心由于网络断开，一晚上的时间就白搭上了。就这样一次次的虐心，一次次失败。测试部的人因为没有测试环境只能在那尴尬的闲着，而我们开发的同样如此，那段时间真是让人“难忘”。于是第一周，我们的进度几乎为零。然而万幸的是最后终于在LDAP上添加了vlv索引，并修改UDI同步工具，总算把第一个测试环境的数据整了出来。

本以为测试的数据整出来我们可以轻松一把，没想到他们的WAS打包的那么不靠谱。测试的人测完了第一轮，晚上，我检查测试环境的更新情况时却发现之前给的补丁包并没有打上去。于是，第一轮的测试以“白测”而告终。不得已，我直接接手了他们的测试环境，什么事情还是自己来才放心。这得多亏了我以前对于WAS以及Linux的学习和了解，这下终于派上了用场，在输入命令轻敲回车的瞬间，心中充满了惬意。渐渐的，测试环境终于在我手中变的非常顺滑，各种问题可以很快定位原因并解决。

第二轮测试的时候，时间已飞快的来到了月底。测试紧张的进行，Bug数很多，但是测出的Bug质量却不高，很多重复的，很多边缘但并不严重的。看着那些Bug单，然后回想主线代码的杂乱无章，各种功能代码的交叉提交，心中无限忐忑。前路总是艰难，迷茫，既然走在了这条路上，我们唯有勇往直前，脚踏实地的走下去。改Bug，上传代码，打补丁包，更新，测试，回归，一步一个脚印。有句话叫你为什么要爬那座山，因为山在那里！而我那时最想说的是，为什么要熬夜去改Bug，因为问题在那里！

上线前几天，经过几次的上线演练，我们信心倍增，特别是我，对于UDI工具的使用，Radis的配置，已经达到了得心应手的程度。而亚坤他们的升级脚本，ESA数据以及刷数据工具，都已成熟起来，没有什么问题了。把几次演练的过程，汇聚起来，我写了份升级手册，在十一月四号晚上终于迎来了上线的时间。晚上九点，我们开始了升级。执行数据库脚本，同步ESA数据，运行UDI迁移工具，执行刷数据脚本...这些如期的顺利执行完后，开始测试。当晚即测出多个问题，有的甚至非常严重几乎要导致回退的地步，比如casp导致的单点登录失败，iam因工单窗口无反应而无法进行操作授权等，上线当晚即提交了7个补丁，不得不感叹计划不如变化快。在不知不觉中，天亮了，当最后看到领导发出的邮件了，那个不算很大的红色的上线成功四个字时，即使熬夜心中悠然